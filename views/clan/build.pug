extends ../no-cache-sub-relayout.pug

block vars
  - let options = {active: league, title: "REBBL season 12", company:"clan"}
  - let company = "clan";

block head  
  style.
    .popoverFix {z-index:10000 !important;}
    .tables {width: 100%;overflow: auto;display: flex;flex-wrap: wrap;margin-top: 1em;align-items: flex-start;}
    .table {width:unset !important; margin-block-end: 1em;margin-right: 1em;flex-grow:1}
    .data {text-align: right}
    .cured {opacity: 0.4}
    .table th {border-top:unset !important;}   
    .btn:focus, .btn.primary:focus {box-shadow:unset !important}
    .skill{width: 2em;border-radius: 4px;margin-left:1px;}
    .bg-double{background-color:#ff8900}
    .choose-race{background: #ffc1075e;}
    .lds-hourglass {display: inline-block;position: relative;width: 80px;height: 80px;}
    .lds-hourglass:after {content: " ";display: block; border-radius: 50%;width: 0;height: 0;margin: 8px;box-sizing: border-box;border: 32px solid #fff;border-color: #ff8900  transparent #ff8900 transparent;animation: lds-hourglass 1.2s infinite;}
    @keyframes lds-hourglass {
      0% {
        transform: rotate(0);
        animation-timing-function: cubic-bezier(0.55, 0.055, 0.675, 0.19);
      }
      50% {
        transform: rotate(900deg);
        animation-timing-function: cubic-bezier(0.215, 0.61, 0.355, 1);
      }
      100% {
        transform: rotate(1800deg);
      }
    }    

block content
  div(class=`` id="app" style="display:none")
    // ko if: loading
    .lds-hourglass    
    // /ko
    // ko if: registerClan
    // ko template: { name: 'registerClanTemplate' }
    // /ko
    // /ko
    // ko if: editClan
    // ko template: { name: 'clanTemplate' }
    // /ko
    // /ko
    // ko if: editTeam && team
    // ko template: { name: 'teamTemplate', data: team }
    // /ko
    // /ko

block scripts
  script(src="https://cdn2.rebbl.net/scripts/knockout-3.4.2.js")
  script(src="https://cdn2.rebbl.net/scripts/knockout-mapping.min.js")
  script(src="https://cdn2.rebbl.net/scripts/knockout-es5.js")
  include templates/includes.pug

  include scripts/includes.pug

  script.
    let SkillDescriptions = [];
    let races = [];
    let skills = [];
    let playerTypes = [];
    let me = {};

    const stringifyWithoutOriginal = (value) => JSON.stringify(value, (key, val) => key === "_original" ? undefined : val);

    const SPP = [
      {level:1,	spp:0, eligible:3},
      {level:2,	spp:6, eligible:11},
      {level:3,	spp:16, eligible:23},
      {level:4,	spp:31, eligible:41},
      {level:5,	spp:51, eligible:63},
      {level:6,	spp:76, eligible:126},
      {level:7,	spp:176, eligible:999}
    ];

    const TierTax = [
      {race:'Chaos Dwarf', tier:	2, rebate: 100000},
      {race:'Lizardman', tier:	1, rebate: 150000},
      {race:'Undead', tier:	3, rebate: 50000},
      {race:'Necromantic', tier:	2, rebate: 100000},
      {race:'Wood Elf', tier:	3, rebate: 50000},
      {race:'Dark Elf', tier:	2, rebate: 100000},
      {race:'Dwarf', tier:	2, rebate: 100000},
      {race:'Orc', tier:	1, rebate: 150000},
      {race:'Chaos', tier:	2, rebate: 100000},
      {race:'Skaven', tier:	1, rebate: 150000},
      {race:'Norse', tier:	5, rebate: -50000},
      {race:'High Elf', tier:	5, rebate: -50000},
      {race:'Khemri', tier:	3, rebate: 50000},
      {race:'Amazon', tier:	3, rebate: 50000},
      {race:'Elven Union', tier:	5, rebate: -50000},
      {race:'Nurgle', tier:	3, rebate: 50000},
      {race:'Bretonnian', tier:	4, rebate: 0},
      {race:'Human', tier:	5, rebate: -50000},
      {race:'Underworld Denizens', tier:	6, rebate: -100000},
      {race:'Kislev', tier:	6, rebate: -100000},
      {race:'Ogre', tier:	6, rebate: -100000},
      {race:'Vampire', tier:	6, rebate: -100000},
      {race:'Goblin', tier:	7, rebate: 0},
      {race:'Halfling', tier:	7, rebate: 0},
    ];

    const Powers = [
      {key:'assassination', name:'Assassination', use:2, cost:100},
      {key:'badInducementDeal', name:'Bad Inducement Deal', use:2, cost:50},
      {key:'confusion', name:'Confusion', use:2, cost:50},
      {key:'financialFairPlay', name:'Financial Fair Play', use:2, cost:50},
      {key:'hatredOfPublicTransport', name:'Hatred of Public Transport', use:5, cost:20},
      {key:'inspiration', name:'Inspiration', use:2, cost:100},
      {key:'lastMinuteSwitch', name:'Last Minute Switch', use:1, cost:150},
      {key:'miscommunication', name:'Miscommunication', use:1, cost:150},
      {key:'stuntyAssassination', name:'Stunty Assassination', use:2, cost:100},
      {key:'stuntyBadInducementDeal', name:'Stunty Bad Inducement Deal', use:2, cost:50},
      {key:'stuntyConfusion', name:'Stunty Confusion', use:2, cost:50},
      {key:'stuntyHatredOfPublicTransport', name:'Stunty Hatred of Public Transport', use:5, cost:20}
      {key:'stuntyInspiration', name:'Stunty Inspiration', use:2, cost:100},
      {key:'stuntyLastMinuteSwitch', name:'Stunty LastMinuteSwitch', use:1, cost:150},
      {key:'stuntyMiscommunication', name:'Stunty Miscommunication', use:1, cost:150},
    ];

    let model = new ClanModel().snap();
    $(document).ready(function(){
       ko.applyBindings(model);
        model.load();
        $("#app").show();
    }); 